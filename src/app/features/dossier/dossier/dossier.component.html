<!-- src/app/features/dossier/dossier.component.html -->
<div class="dossier-container">
    <header class="dossier-header">
      <div class="logo">ENVALPRO</div>
      <h1 class="title">GEB√ÑUDEANALYSE DER {{building.address | uppercase}}</h1>
      <h2 class="subtitle">ENERGIEEFFIZIENZ ‚Äì F√ñRDERUNG - POTENTIAL</h2>
    </header>
  
    <div class="tabs" [class.scrolled]="scrolled">
      <button [class.active]="activeTab === 'overview'" (click)="setActiveTab('overview')">√úbersicht</button>
      <button [class.active]="activeTab === 'buildingData'" (click)="setActiveTab('buildingData')">Geb√§udedaten</button>
      <button [class.active]="activeTab === 'consumption'" (click)="setActiveTab('consumption')">Verbrauch & ESG</button>
      <button [class.active]="activeTab === 'analysis'" (click)="setActiveTab('analysis')">Bestandsanalyse</button>
      <button [class.active]="activeTab === 'renovation'" (click)="setActiveTab('renovation')">Sanierungsma√ünahmen</button>
      <button [class.active]="activeTab === 'timeline'" (click)="setActiveTab('timeline')">iSFP-Fahrplan</button>
    </div>
  
    <!-- Overview Tab -->
    <div class="tab-content" [@tabAnimation] *ngIf="activeTab === 'overview'">
      <div class="overview-section">
        <h2>Zustand Wohnh√§user in Deutschland</h2>
        
        <div class="stats-circles">
          <div class="stat-circle">
            <div class="circle-value">70%</div>
            <div class="circle-label">der Wohngeb√§ude werden noch mit Gas beheizt</div>
          </div>
          <div class="stat-circle">
            <div class="circle-value">40%</div>
            <div class="circle-label">der Wohngeb√§ude haben eine schlechtere Energieeffizienzklasse als C</div>
          </div>
          <div class="stat-circle">
            <div class="circle-value">>60%</div>
            <div class="circle-label">der Wohngeb√§ude sind nicht EU-Konform (1.5¬∞ Road to Paris)</div>
          </div>
        </div>
  
        <div class="two-columns">
          <div class="column">
            <h3>Warum √ºberhaupt Sanieren?</h3>
            <p>
              Eine energetische Sanierung optimiert die Energieeffizienz eines Geb√§udes durch gezielte bauliche
              Ma√ünahmen, was zu sp√ºrbaren Kosteneinsparungen bei Heizung, Warmwasseraufbereitung und Bel√ºftung f√ºhrt.
              Dies ist besonders relevant vor dem Hintergrund steigender Energiepreise.
            </p>
            <p>
              Gleichzeitig tr√§gt die Sanierung zur Reduzierung des CO2-Aussto√ües bei und f√∂rdert den Einsatz
              erneuerbarer Energien, was einen wertvollen Beitrag zur Umweltschonung darstellt.
            </p>
          </div>
          <div class="column">
            <h3>Was die Modernisierung bringt?</h3>
            <ul class="benefits-list">
              <li>Wohnwerterh√∂hung</li>
              <li>Verbesserte Wohnqualit√§t</li>
              <li>Niedrigere Energie- & CO2-Kosten</li>
              <li>Wertsteigerung und Rentabilit√§t</li>
              <li>Langfristige Mieterbindung</li>
              <li>Vermeidung von Wertverlust</li>
              <li>Versorgungssicherheit eigener Strom</li>
              <li>Unabh√§ngigkeit durch W√§rmepumpen</li>
            </ul>
          </div>
        </div>
  
        <div class="benefits-icons">
          <div class="benefit-icon">
            <div class="icon">üìà</div>
            <div class="benefit-text">Bis zu 31% Wertsteigerung</div>
          </div>
          <div class="benefit-icon">
            <div class="icon">üèõÔ∏è</div>
            <div class="benefit-text">Bis zu 70% F√∂rderung</div>
          </div>
          <div class="benefit-icon">
            <div class="icon">üè†</div>
            <div class="benefit-text">H√∂here Mieteinnahmen</div>
          </div>
          <div class="benefit-icon">
            <div class="icon">üí∞</div>
            <div class="benefit-text">H√∂herer Wiederverkauf</div>
          </div>
        </div>
  
        <div class="envalpro-promise">
          <p>
            Envalpro hilft Vermietern die Mieteinnahmen und den Wert der Immobilie durch energetische Ma√ünahmen
            zu steigern und die F√∂rdermittel maximal zu nutzen, die Immobilie in die Zukunft zu f√ºhren- und das als
            One-Stop-Shop
          </p>
        </div>
      </div>
    </div>
  
    <!-- Building Data Tab -->
    <div class="tab-content" [@tabAnimation] *ngIf="activeTab === 'buildingData'">
      <app-building-data></app-building-data>
    </div>
  
    <!-- Consumption Tab - This would be replaced with a proper component -->
    <div class="tab-content" [@tabAnimation] *ngIf="activeTab === 'consumption'">
      <div class="consumption-section">
        <h2>Ihre aktuellen Verbr√§uche und allgemeine Daten</h2>
  
        <div class="consumption-data">
          <table class="data-table">
            <tr class="table-header">
              <th colspan="2">AKTUELLE DATEN UND VERBRAUCH</th>
            </tr>
            <tr>
              <td>Heizung in kWh* ca.</td>
              <td>{{consumptionData.heating | number}}</td>
            </tr>
            <tr>
              <td>Warmwasser in kWh* ca.</td>
              <td>{{consumptionData.warmWater | number}}</td>
            </tr>
            <tr>
              <td>Strom in kWh* ca.</td>
              <td>{{consumptionData.electricity | number}}</td>
            </tr>
            <tr>
              <td>Energie in kWh total* ca.</td>
              <td>{{consumptionData.totalEnergy | number}}</td>
            </tr>
            <tr>
              <td>Mietpreis in ‚Ç¨ pro m¬≤</td>
              <td>-</td>
            </tr>
            <tr>
              <td>Marktpreis in ‚Ç¨ pro m¬≤ ca.</td>
              <td>1.500</td>
            </tr>
            <tr>
              <td>Energiekosten in ‚Ç¨* ca.</td>
              <td>{{consumptionData.energyCosts | number}}</td>
            </tr>
            <tr>
              <td>C02-Emissionen in kg ca.</td>
              <td>{{consumptionData.co2Emissions | number}}</td>
            </tr>
            <tr>
              <td>Stranded Asset**</td>
              <td><span class="alert">ja</span></td>
            </tr>
          </table>
          <p class="footnote">*Gesch√§tzte Werte, da keine Angaben</p>
          <p class="footnote">**Stranded Asset heisst das Ihre Immobilie nicht den Vorgaben der EU /CRREM entspricht und Wertverlust droht!</p>
        </div>
  
        <!-- Rest of consumption tab content -->
        <!-- This would be replaced with a proper component -->
      </div>
    </div>
  
    <!-- Analysis Tab -->
    <div class="tab-content" [@tabAnimation] *ngIf="activeTab === 'analysis'">
      <div class="analysis-section">
        <h2>Analyse der Bestandssituation</h2>
        
        <div class="analysis-items">
          <div class="analysis-item">
            <h3>Heizung</h3>
            <p>Die Heizungsanlage ist (teilweise) veraltet und weist einen niedrigen Wirkungsgrad auf. Sie verursacht eine hohe CO2-Emission, da sie mit fossilen Brennstoffen betrieben wird.</p>
          </div>
          
          <div class="analysis-item">
            <h3>Dach</h3>
            <p>Ein schlecht ged√§mmtes Dach f√ºhrt zu hohem W√§rmeverlust im Winter und erh√∂htem W√§rmegewinn im Sommer, was zu h√∂heren Heiz- und K√ºhlkosten f√ºhrt und den Komfort im Geb√§ude beeintr√§chtigt.</p>
          </div>
          
          <div class="analysis-item">
            <h3>Kellerdecke</h3>
            <p>Eine nicht ged√§mmte Kellerdecke oder Kellerboden verursacht W√§rmeverluste an den unbeheizten Kellerbereich oder an das Erdreich darunter und f√ºhrt zu unangenehmer Fu√ük√§lte, was den Wohnkomfort beeintr√§chtigt und den Energieverbrauch erh√∂ht.</p>
          </div>
          
          <div class="analysis-item">
            <h3>Fassade</h3>
            <p>Eine nicht ged√§mmte Au√üenfassade verursacht im Winter einen hohen W√§rmeverlust und erh√∂ht im Sommer den W√§rmegewinn im Geb√§ude, was zu h√∂heren Heiz- und K√ºhlkosten f√ºhrt.</p>
          </div>
          
          <div class="analysis-item">
            <h3>Fenster</h3>
            <p>Eine schlechte Verglasung f√ºhrt zu hohem W√§rmeverlust, w√§hrend undichte Abdichtungen Zugluft verursachen, was zu einem ineffizienten Raumklima und einem erh√∂hten Energieverbrauch f√ºhrt.</p>
          </div>
          
          <div class="analysis-item">
            <h3>T√ºren</h3>
            <p>Eine schlechte Au√üent√ºr f√ºhrt zu hohem W√§rmeverlust, w√§hrend undichte Abdichtungen Zugluft verursachen, was zu einem ineffizienten Raumklima und einem erh√∂hten Energieverbrauch f√ºhrt.</p>
          </div>
        </div>
        
        <div class="modernization-chart">
          <h3>MODERNISIERUNG BESSER JETZT ALS SP√ÑTER!</h3>
          
          <!-- Chart Legend -->
          <div class="chart-legend">
            <div class="legend-item">
              <div class="legend-color heute"></div>
              <span>Heute</span>
            </div>
            <div class="legend-item">
              <div class="legend-color in-10-jahren"></div>
              <span>In 10 Jahren</span>
            </div>
            <div class="legend-item">
              <div class="legend-color mehrkosten"></div>
              <span>Mehrkosten in 10 Jahren</span>
            </div>
          </div>
          
          <!-- D3 Chart Container -->
          <div class="d3-chart-container" #chartContainer></div>
          
          <!-- Red Callout Box -->
          <div class="cost-callout">
            <div class="callout-arrow"></div>
            <div class="callout-content">
              <div class="callout-amount">{{modernizationCosts.additionalCosts | currency:'EUR':'symbol':'1.0-0'}}*</div>
              <div class="callout-text">
                <p>W√ºrden Sie in 10 Jahren unn√∂tigerweise mehr zahlen (5% Kostensteigerung p.a.)!</p>
                <p class="callout-note">* ohne Wertverlust Ihrer Immobilie</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- Renovation Measures Tab - This would be replaced with a proper component -->
    <div class="tab-content" [@tabAnimation] *ngIf="activeTab === 'renovation'">
      <div class="renovation-section">
        <h2>√úbersicht Sanierungsma√ünahmen</h2>
        
        <table class="renovation-table">
          <thead>
            <tr>
              <th></th>
              <th>Status</th>
              <th>Beschreibung</th>
              <th>Kosten</th>
              <th>F√∂rderungen</th>
              <th>Einsparungen p.a.</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let measure of renovationMeasures">
              <td class="measure-type">{{measure.type}}</td>
              <td>
                <div class="status">
                  <div>vorher</div>
                  <div>nachher</div>
                </div>
              </td>
              <td>
                <div class="description">
                  <div *ngIf="measure.type === 'Photovoltaik'">Keine Photovoltaik</div>
                  <div *ngIf="measure.type === 'Dach'">Dach nicht ged√§mmt</div>
                  <div *ngIf="measure.type === 'Fenster & T√ºren'">2-fach-Verglasung</div>
                  <div *ngIf="measure.type === 'L√ºftung'">manuelle L√ºftung</div>
                  <div *ngIf="measure.type === 'Heizung'">Gas, Bj. 1994</div>
                  <div *ngIf="measure.type === 'Keller'">Keller nicht ged√§mmt</div>
                  <div *ngIf="measure.type === 'Fassade'">keine zus√§tzl. D√§mmung</div>
                  <div>{{measure.description}}</div>
                </div>
              </td>
              <td>{{measure.cost | currency:'EUR':'symbol':'1.0-0'}}</td>
              <td>{{measure.funding | currency:'EUR':'symbol':'1.0-0'}}</td>
              <td>ca. {{measure.savings | currency:'EUR':'symbol':'1.0-0'}}</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3">Summe</td>
              <td>ca. {{totalCosts | currency:'EUR':'symbol':'1.0-0'}}</td>
              <td>ca. {{totalFunding | currency:'EUR':'symbol':'1.0-0'}}</td>
              <td>ca. {{totalSavings | currency:'EUR':'symbol':'1.0-0'}}</td>
            </tr>
          </tfoot>
        </table>
        
        <div class="savings-potential">
          <h3>Hohes Einsparpotenzial und niedrigere Steuerbelastung</h3>
          <ul>
            <li>{{savingsPotential.energyCostSavings}}% Einsparpotenzial Ihrer Energiekosten</li>
            <li>{{savingsPotential.energyBalanceSavings}}% Einsparpotenzial Ihrer Energiebilanz</li>
            <li>{{savingsPotential.co2TaxSavings}}% Einsparpotenzial Ihrer C02-Steuer</li>
            <li>7 Ma√ünahmen In {{savingsPotential.amortizationYears}} Jahren amortisiert!</li>
          </ul>
        </div>
      </div>
    </div>
  
    <!-- Timeline Tab - This would be replaced with a proper component -->
    <div class="tab-content" [@tabAnimation] *ngIf="activeTab === 'timeline'">
      <div class="timeline-section">
        <h2>Ihre Sanierungsw√ºnsche und iSFP-Fahrplan f√ºr 5 Jahre</h2>
        
        <div class="timeline">
          <table class="timeline-table">
            <thead>
              <tr>
                <th *ngFor="let plan of renovationPlan">{{plan.year}}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let measure of ['Heizung', 'Photovoltaik', 'Schr√§gdach', 'Fenster & T√ºren', 'D√§mmung Fassade', 'D√§mmung Kellerdecke', 'L√ºftungsanlage']">
                <td *ngFor="let plan of renovationPlan" [class.active]="plan.measures.includes(measure)">
                  <div *ngIf="plan.measures.includes(measure)" class="measure-box">
                    <div class="measure-name">{{measure}}</div>
                    <div class="measure-cost">Kosten<br>{{getMeasureCost(measure) | currency:'EUR':'symbol':'1.0-0'}}</div>
                  </div>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td *ngFor="let plan of renovationPlan">
                  <div class="investment">Investition: {{plan.investment | currency:'EUR':'symbol':'1.0-0'}}</div>
                </td>
              </tr>
            </tfoot>
          </table>
        </div>
        
        <p class="timeline-note">
          Bei einer √úberschreitung der f√∂rderf√§higen Kosten durch mehrere Ma√ünahmen an der Geb√§udeh√ºlle empfiehlt es sich, die Ma√ünahmen auf mehrere Jahre zu verteilen. PV wird nicht gef√∂rdert, hat jedoch h√∂chste Kostenersparnisse!
        </p>
      </div>
    </div>
  
    <footer class="dossier-footer">
      <div class="footer-logo">ENVALPRO</div>
      <div class="footer-website">www.envalpro-impact.com</div>
    </footer>
  </div>